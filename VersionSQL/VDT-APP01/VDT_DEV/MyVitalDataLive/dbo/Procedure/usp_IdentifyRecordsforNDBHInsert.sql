/****** Object:  Procedure [dbo].[usp_IdentifyRecordsforNDBHInsert]    Committed by VersionSQL https://www.versionsql.com ******/

	-- Query for New Directions referrals based on ER visits and a behavioral health diagnosis
	-- Exclude members that cannot be contacted or have been contacted or are in case management

CREATE PROCEDURE usp_IdentifyRecordsforNDBHInsert
AS
BEGIN
/************************
Author: Deepank Johri
Created Date: 09-07-2021
Example: exec usp_IdentifyRecordsforNDBHInsert
Modifications:
WHO       WHEN          WHAT

************************/

	DROP TABLE IF EXISTS #ExcludedMVDID
	DROP TABLE IF EXISTS #ERVisit
	CREATE TABLE #ExcludedMVDID (MVDID varchar(30))

	INSERT INTO #ExcludedMVDID (MVDID)
	SELECT distinct(MVDID)
	  FROM CFR_Rule_Exclusion (readuncommitted) re
	  JOIN HPWorkFlowRule (readuncommitted) wfr ON wfr.Rule_ID = re.RuleID
	  JOIN CFR_ExcludedMVDID (readuncommitted) em ON em.ExclusionID = re.ExclusionID
	  JOIN CFR_Exclusion (readuncommitted) e ON em.ExclusionID = e.ID
	  where ruleid = 214

   CREATE NONCLUSTERED INDEX [IX_#ExcludedMVDID_MVDID] ON #ExcludedMVDID ([MVDID] ASC)

	-- accounts for more than 1 ER visit
	-- accounts for having a New Directions benefit
	SELECT FCH.MVDID,COUNT(DISTINCT StatementFromDate) ERCount
		INTO #ERVisit
		FROM finalclaimsheader (readuncommitted) FCH
		JOIN ComputedCareQueue (readuncommitted) CCQ on CCQ.MVDID = FCH.MVDID
		LEFT JOIN ComputedMemberAlert (readuncommitted) CA on CA.MVDID = CCQ.MVDID
		JOIN FinalMember (readuncommitted) FM on FM.MVDID = CCQ.MVDID
		WHERE 
        DATEDIFF( DAY, StatementFromDate, GetUTCDate() ) <= 365		-- rolling 12 month lookback
        AND ISNULL(EmergencyIndicator,0) = 1						-- include only ER visits per EBI definition
		AND ISNULL(AdjustmentCode,'O') != 'A'						-- ignore adjustement claims
		AND CCQ.IsActive = 1										-- must currently be enrolled in plan
		AND ISNULL(FM.CompanyKey,'0000') != '1338'					-- not assigned to ABCBS employee company
		AND ISNULL(CCQ.CaseOwner,'--') = '--'						-- does not currently have a medical / SW case manager assigned
		AND ISNULL(CA.PersonalHarm,0) = 0							-- no Personal Harm / no contact alert
		AND ISNULL(FM.COBCD,'U') IN ('S','N','U')					-- has primary coverage by ABCBS
		AND FM.GrpInitvCd != 'GRD'									-- exclude members associated to Grand Rounds
  --      AND NOT EXISTS 
		--	(SELECT 1 FROM #ExcludedMVDID WHERE MVDID = CCQ.MVDID)	-- not in an excluded company for benefits
		AND FM.NewDirSvcCd in ('CM','UMCM','UM')					-- Serviced by New Directions
		GROUP BY FCH.MVDID
		HAVING COUNT(DISTINCT StatementFromDate) > 1

    CREATE NONCLUSTERED INDEX [IX_#ERVisit_MVDID] ON #ERVisit ([MVDID] ASC,ERCount ASC)

	DROP TABLE IF EXISTS #PanicAnxietydisorders

	-- 1-Panic d/o & Anxiety disorders + 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion, ER.ErCount,'Panic d/o & Anxiety disorders' as Category
	    into #PanicAnxietydisorders
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F40','F400','F4000','F4001','F4002','F401','F4010','F4011','F402','F4021','F40210','F40218','F4022','F40220','F40228','F4023','F40230','F40231',
		'F40232','F40233','F4024','F40240','F40241','F40242','F40243','F40248','F4029','F40290','F40291','F40298','F408','F409','F41','F410','F411','F413',
		'F418','F419','F42','F422','F423','F424','F428','F429')

	--union

		DROP TABLE IF EXISTS #personalitydisorders

	-- 2-Axis 2 personality disorders (Borderline PD or Dependent PD) + 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Axis 2 personality disorders (Borderline PD or Dependent PD)' as Category
		into #personalitydisorders
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F60','F600','F601','F602','F603','F604','F605','F606','F607','F608','F6081','F6089','F609'
		)

	--union

		DROP TABLE IF EXISTS #bipolardisorders

	-- 3-Bipolar d/o +2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Bipolar d/o' as Category
		into #bipolardisorders
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F30','F301','F3010','F3011','F3012','F3013','F302','F303','F304','F308','F309','F31','F310','F311','F3110','F3111','F3112','F3113','F312','F313',
		'F3130','F3131','F3132','F314','F315','F316','F3160','F3161','F3162','F3163','F3164','F317','F3170','F3171','F3172','F3173','F3174','F3175','F3176',
		'F3177','F3178','F318','F3181','F3189','F319'
		)

	--union

		DROP TABLE IF EXISTS #Schizophrenia

	-- 4-Schizophrenia + 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Schizophrenia' as Category
		into #Schizophrenia
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F20','F200','F201','F202','F203','F205','F208','F2081','F2089','F209'
		)

	--union

		DROP TABLE IF EXISTS #Suicidology


	-- 5-Suicidology + 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Suicidology' as Category
		into #Suicidology
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'R45851', 'T1491','T1491XA','T1491XD','T1491XS','T360X2A','T360X2D','T360X2S','T361X2A','T361X2D','T361X2S','T362X2A','T362X2D','T362X2S','T363X2A','T363X2D','T363X2S','T364X2A',
		'T364X2D','T364X2S','T365X2A','T365X2D','T365X2S','T366X2A','T366X2D','T366X2S','T367X2A','T367X2D','T367X2S','T368X2A','T368X2D','T368X2S','T3692XA','T3692XD','T3692XS','T370X2A',
		'T370X2D','T370X2S','T371X2A','T371X2D','T371X2S','T372X2A','T372X2D','T372X2S','T373X2A','T373X2D','T373X2S','T374X2A','T374X2D','T374X2S','T375X2A','T375X2D','T375X2S','T378X2A',
		'T378X2D','T378X2S','T3792XA','T3792XD','T3792XS','T380X2A','T380X2D','T380X2S','T381X2A','T381X2D','T381X2S','T382X2A','T382X2D','T382X2S','T383X2A','T383X2D','T383X2S','T384X2A',
		'T384X2D','T384X2S','T385X2A','T385X2D','T385X2S','T386X2A','T386X2D','T386X2S','T387X2A','T387X2D','T387X2S','T38802A','T38802D','T38802S','T38812A','T38812D','T38812S','T38892A',
		'T38892D','T38892S','T38902A','T38902D','T38902S','T38992A','T38992D','T38992S','T39012A','T39012D','T39012S','T39092A','T39092D','T39092S','T391X2A','T391X2D','T391X2S','T392X2A',
		'T392X2D','T392X2S','T39312A','T39312D','T39312S','T39392A','T39392D','T39392S','T394X2A','T394X2D','T394X2S','T398X2A','T398X2D','T398X2S','T3992XA','T3992XD','T3992XS','T400X2A',
		'T400X2D','T400X2S','T401X2A','T401X2D','T401X2S','T402X2A','T402X2D','T402X2S','T403X2A','T403X2D','T403X2S','T404X2A','T404X2D','T404X2S','T405X2A','T405X2D','T405X2S','T40602A',
		'T40602D','T40602S','T40692A','T40692D','T40692S','T407X2A','T407X2D','T407X2S','T408X2A','T408X2D','T408X2S','T40902A','T40902D','T40902S','T40992A','T40992D','T40992S','T410X2A',
		'T410X2D','T410X2S','T411X2A','T411X2D','T411X2S','T41202A','T41202D','T41202S','T41292A','T41292D','T41292S','T413X2A','T413X2D','T413X2S','T4142XA','T4142XD','T4142XS','T415X2A',
		'T415X2D','T415X2S','T420X2A','T420X2D','T420X2S','T421X2A','T421X2D','T421X2S','T422X2A','T422X2D','T422X2S','T423X2A','T423X2D','T423X2S','T424X2A','T424X2D','T424X2S','T425X2A',
		'T425X2D','T425X2S','T426X2A','T426X2D','T426X2S','T4272XA','T4272XD','T4272XS','T428X2A','T428X2D','T428X2S','T43012A','T43012D','T43012S','T43022A','T43022D','T43022S','T431X2A',
		'T431X2D','T431X2S','T43202A','T43202D','T43202S','T43212A','T43212D','T43212S','T43222A','T43222D','T43222S','T43292A','T43292D','T43292S','T433X2A','T433X2D','T433X2S','T434X2A',
		'T434X2D','T434X2S','T43502A','T43502D','T43502S','T43592A','T43592D','T43592S','T43602A','T43602D','T43602S','T43612A','T43612D','T43612S','T43622A','T43622D','T43622S','T43632A',
		'T43632D','T43632S','T43692A','T43692D','T43692S','T438X2A','T438X2D','T438X2S','T4392XA','T4392XD','T4392XS','T440X2A','T440X2D','T440X2S','T441X2A','T441X2D','T441X2S','T442X2A',
		'T442X2D','T442X2S','T443X2A','T443X2D','T443X2S','T444X2A','T444X2D','T444X2S','T445X2A','T445X2D','T445X2S','T446X2A','T446X2D','T446X2S','T447X2A','T447X2D','T447X2S','T448X2A',
		'T448X2D','T448X2S','T44902A','T44902D','T44902S','T44992A','T44992D','T44992S','T450X2A','T450X2D','T450X2S','T451X2A','T451X2D','T451X2S','T452X2A','T452X2D','T452X2S','T453X2A',
		'T453X2D','T453X2S','T454X2A','T454X2D','T454X2S','T45512A','T45512D','T45512S','T45522A','T45522D','T45522S','T45602A','T45602D','T45602S','T45612A','T45612D','T45612S','T45622A',
		'T45622D','T45622S','T45692A','T45692D','T45692S','T457X2A','T457X2D','T457X2S','T458X2A','T458X2D','T458X2S','T4592XA','T4592XD','T4592XS','T460X2A','T460X2D','T460X2S','T461X2A',
		'T461X2D','T461X2S','T462X2A','T462X2D','T462X2S','T463X2A','T463X2D','T463X2S','T464X2A','T464X2D','T464X2S','T465X2A','T465X2D','T465X2S','T466X2A','T466X2D','T466X2S','T467X2A',
		'T467X2D','T467X2S','T468X2A','T468X2D','T468X2S','T46902A','T46902D','T46902S','T46992A','T46992D','T46992S','T470X2A','T470X2D','T470X2S','T471X2A','T471X2D','T471X2S','T472X2A',
		'T472X2D','T472X2S','T473X2A','T473X2D','T473X2S','T474X2A','T474X2D','T474X2S','T475X2A','T475X2D','T475X2S','T476X2A','T476X2D','T476X2S','T477X2A','T477X2D','T477X2S','T478X2A',
		'T478X2D','T478X2S','T4792XA','T4792XD','T4792XS','T480X2A','T480X2D','T480X2S','T481X2A','T481X2D','T481X2S','T48202A','T48202D','T48202S','T48292A','T48292D','T48292S','T483X2A',
		'T483X2D','T483X2S','T484X2A','T484X2D','T484X2S','T485X2A','T485X2D','T485X2S','T486X2A','T486X2D','T486X2S','T48902A','T48902D','T48902S','T48992A','T48992D','T48992S','T490X2A',
		'T490X2D','T490X2S','T491X2A','T491X2D','T491X2S','T492X2A','T492X2D','T492X2S','T493X2A','T493X2D','T493X2S','T494X2A','T494X2D','T494X2S','T495X2A','T495X2D','T495X2S','T496X2A',
		'T496X2D','T496X2S','T497X2A','T497X2D','T497X2S','T498X2A','T498X2D','T498X2S','T4992XA','T4992XD','T4992XS','T500X2A','T500X2D','T500X2S','T501X2A','T501X2D','T501X2S','T502X2A',
		'T502X2D','T502X2S','T503X2A','T503X2D','T503X2S','T504X2A','T504X2D','T504X2S','T505X2A','T505X2D','T505X2S','T506X2A','T506X2D','T506X2S','T507X2A','T507X2D','T507X2S','T508X2A',
		'T508X2D','T508X2S','T50902A','T50902D','T50902S','T50992A','T50992D','T50992S','T50A12A','T50A12D','T50A12S','T50A22A','T50A22D','T50A22S','T50A92A','T50A92D','T50A92S','T50B12A',
		'T50B12D','T50B12S','T50B92A','T50B92D','T50B92S','T50Z12A','T50Z12D','T50Z12S','T50Z92A','T50Z92D','T50Z92S','T510X2A','T510X2D','T510X2S','T511X2A','T511X2D','T511X2S','T512X2A',
		'T512X2D','T512X2S','T513X2A','T513X2D','T513X2S','T518X2A','T518X2D','T518X2S','T5192XA','T5192XD','T5192XS','T520X2A','T520X2D','T520X2S','T521X2A','T521X2D','T521X2S','T522X2A',
		'T522X2D','T522X2S','T523X2A','T523X2D','T523X2S','T524X2A','T524X2D','T524X2S','T528X2A','T528X2D','T528X2S','T5292XA','T5292XD','T5292XS','T530X2A','T530X2D','T530X2S','T531X2A',
		'T531X2D','T531X2S','T532X2A','T532X2D','T532X2S','T533X2A','T533X2D','T533X2S','T534X2A','T534X2D','T534X2S','T535X2A','T535X2D','T535X2S','T536X2A','T536X2D','T536X2S','T537X2A',
		'T537X2D','T537X2S','T5392XA','T5392XD','T5392XS','T540X2A','T540X2D','T540X2S','T541X2A','T541X2D','T541X2S','T542X2A','T542X2D','T542X2S','T543X2A','T543X2D','T543X2S','T5492XA',
		'T5492XD','T5492XS','T550X2A','T550X2D','T550X2S','T551X2A','T551X2D','T551X2S','T560X2A','T560X2D','T560X2S','T561X2A','T561X2D','T561X2S','T562X2A','T562X2D','T562X2S','T563X2A',
		'T563X2D','T563X2S','T564X2A','T564X2D','T564X2S','T565X2A','T565X2D','T565X2S','T566X2A','T566X2D','T566X2S','T567X2A','T567X2D','T567X2S','T56812A','T56812D','T56812S','T56892A',
		'T56892D','T56892S','T5692XA','T5692XD','T5692XS','T570X2A','T570X2D','T570X2S','T571X2A','T571X2D','T571X2S','T572X2A','T572X2D','T572X2S','T573X2A','T573X2D','T573X2S','T578X2A',
		'T578X2D','T578X2S','T5792XA','T5792XD','T5792XS','T5802XA','T5802XD','T5802XS','T5812XA','T5812XD','T5812XS','T582X2A','T582X2D','T582X2S','T588X2A','T588X2D','T588X2S','T5892XA',
		'T5892XD','T5892XS','T590X2A','T590X2D','T590X2S','T591X2A','T591X2D','T591X2S','T592X2A','T592X2D','T592X2S','T593X2A','T593X2D','T593X2S','T594X2A','T594X2D','T594X2S','T595X2A',
		'T595X2D','T595X2S','T596X2A','T596X2D','T596X2S','T597X2A','T597X2D','T597X2S','T59812A','T59812D','T59812S','T59892A','T59892D','T59892S','T5992XA','T5992XD','T5992XS','T600X2A',
		'T600X2D','T600X2S','T601X2A','T601X2D','T601X2S','T602X2A','T602X2D','T602X2S','T603X2A','T603X2D','T603X2S','T604X2A','T604X2D','T604X2S','T608X2A','T608X2D','T608X2S','T6092XA',
		'T6092XD','T6092XS','T6102XA','T6102XD','T6102XS','T6112XA','T6112XD','T6112XS','T61772A','T61772D','T61772S','T61782A','T61782D','T61782S','T618X2A','T618X2D','T618X2S','T6192XA',
		'T6192XD','T6192XS','T620X2A','T620X2D','T620X2S','T621X2A','T621X2D','T621X2S','T622X2A','T622X2D','T622X2S','T628X2A','T628X2D','T628X2S','T6292XA','T6292XD','T6292XS','T63002A',
		'T63002D','T63002S','T63012A','T63012D','T63012S','T63022A','T63022D','T63022S','T63032A','T63032D','T63032S','T63042A','T63042D','T63042S','T63062A','T63062D','T63062S','T63072A',
		'T63072D','T63072S','T63082A','T63082D','T63082S','T63092A','T63092D','T63092S','T63112A','T63112D','T63112S','T63122A','T63122D','T63122S','T63192A','T63192D','T63192S','T632X2A',
		'T632X2D','T632X2S','T63302A','T63302D','T63302S','T63312A','T63312D','T63312S','T63322A','T63322D','T63322S','T63332A','T63332D','T63332S','T63392A','T63392D','T63392S','T63412A',
		'T63412D','T63412S','T63422A','T63422D','T63422S','T63432A','T63432D','T63432S','T63442A','T63442D','T63442S','T63452A','T63452D','T63452S','T63462A','T63462D','T63462S','T63482A',
		'T63482D','T63482S','T63512A','T63512D','T63512S','T63592A','T63592D','T63592S','T63612A','T63612D','T63612S','T63622A','T63622D','T63622S','T63632A','T63632D','T63632S','T63692A',
		'T63692D','T63692S','T63712A','T63712D','T63712S','T63792A','T63792D','T63792S','T63812A','T63812D','T63812S','T63822A','T63822D','T63822S','T63832A','T63832D','T63832S','T63892A',
		'T63892D','T63892S','T6392XA','T6392XD','T6392XS','T6402XA','T6402XD','T6402XS','T6482XA','T6482XD','T6482XS','T650X2A','T650X2D','T650X2S','T651X2A','T651X2D','T651X2S','T65212A',
		'T65212D','T65212S','T65222A','T65222D','T65222S','T65292A','T65292D','T65292S','T653X2A','T653X2D','T653X2S','T654X2A','T654X2D','T654X2S','T655X2A','T655X2D','T655X2S','T656X2A',
		'T656X2D','T656X2S','T65812A','T65812D','T65812S','T65822A','T65822D','T65822S','T65832A','T65832D','T65832S','T65892A','T65892D','T65892S','T6592XA','T6592XD','T6592XS','T71112A',
		'T71112D','T71112S','T71122A','T71122D','T71122S','T71132A','T71132D','T71132S','T71152A','T71152D','T71152S','T71162A','T71162D','T71162S','T71192A','T71192D','T71192S','T71222A',
		'T71222D','T71222S','T71232A','T71232D','T71232S','X710XXA','X710XXD','X710XXS','X711XXA','X711XXD','X711XXS','X712XXA','X712XXD','X712XXS','X713XXA','X713XXD','X713XXS','X718XXA',
		'X718XXD','X718XXS','X719XXA','X719XXD','X719XXS','X72XXXA','X72XXXD','X72XXXS','X730XXA','X730XXD','X730XXS','X731XXA','X731XXD','X731XXS','X732XXA','X732XXD','X732XXS','X738XXA',
		'X738XXD','X738XXS','X739XXA','X739XXD','X739XXS','X7401XA','X7401XD','X7401XS','X7402XA','X7402XD','X7402XS','X7409XA','X7409XD','X7409XS','X748XXA','X748XXD','X748XXS','X749XXA',
		'X749XXD','X749XXS','X75XXXA','X75XXXD','X75XXXS','X76XXXA','X76XXXD','X76XXXS','X770XXA','X770XXD','X770XXS','X771XXA','X771XXD','X771XXS','X772XXA','X772XXD','X772XXS','X773XXA',
		'X773XXD','X773XXS','X778XXA','X778XXD','X778XXS','X779XXA','X779XXD','X779XXS','X780XXA','X780XXD','X780XXS','X781XXA','X781XXD','X781XXS','X782XXA','X782XXD','X782XXS','X788XXA',
		'X788XXD','X788XXS','X789XXA','X789XXD','X789XXS','X79XXXA','X79XXXD','X79XXXS','X80XXXA','X80XXXD','X80XXXS','X810XXA','X810XXD','X810XXS','X811XXA','X811XXD','X811XXS','X818XXA',
		'X818XXD','X818XXS','X820XXA','X820XXD','X820XXS','X821XXA','X821XXD','X821XXS','X822XXA','X822XXD','X822XXS','X828XXA','X828XXD','X828XXS','X830XXA','X830XXD','X830XXS','X831XXA',
		'X831XXD','X831XXS','X832XXA','X832XXD','X832XXS','X838XXA','X838XXD','X838XXS','Z915'
		)

	--union

		DROP TABLE IF EXISTS #Eatingdisorder

	-- 6-Eating d/o and 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Eating d/o' as Category
		into #Eatingdisorder
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F50','F500','F5000','F5001','F5002','F502','F508','F5081','F5082','F5089','F509'
		)

	--union

    	DROP TABLE IF EXISTS #SUDDx

	-- 7-SUD dx and 2,3,4 & 5 or more ER visits (does not have to be primary dx)
	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'SUD dx' as Category
		into #SUDDx
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F10','F1010','F1011','F1012','F10120','F10121','F10129','F1014','F1015','F10150','F10151','F10159','F1018','F10180','F10181','F10182','F10188','F1019','F102','F1020','F1021','F1022',
		'F10220','F10221','F10229','F1023','F10230','F10231','F10232','F10239','F1024','F1025','F10250','F10251','F10259','F1026','F1027','F1028','F10280','F10281','F10282','F10288','F1029',
		'F109','F1092','F10920','F10921','F10929','F1094','F1095','F10950','F10951','F10959','F1096','F1097','F1098','F10980','F10981','F10982','F10988','F1099','F11','F111','F1110','F1111',
		'F1112','F11120','F11121','F11122','F11129','F1114','F1115','F11150','F11151','F11159','F1118','F11181','F11182','F11188','F1119','F112','F1120','F1121','F1122','F11220','F11221','F11222',
		'F11229','F1123','F1124','F1125','F11250','F11251','F11259','F1128','F11281','F11282','F11288','F1129','F119','F1190','F1192','F11920','F11921','F11922','F11929','F1193','F1194','F1195',
		'F11950','F11951','F11959','F1198','F11981','F11982','F11988','F1199','F12','F121','F1210','F1211','F1212','F12120','F12121','F12122','F12129','F1215','F12150','F12151','F12159','F1218',
		'F12180','F12188','F1219','F122','F1220','F1221','F1222','F12220','F12221','F12222','F12229','F1225','F12250','F12251','F12259','F1228','F12280','F12288','F1229','F129','F1290','F1292',
		'F12920','F12921','F12922','F12929','F1295','F12950','F12951','F12959','F1298','F12980','F12988','F1299','F13','F131','F1310','F1311','F1312','F13120','F13121','F13129','F1314','F1315',
		'F13150','F13151','F13159','F1318','F13180','F13181','F13182','F13188','F1319','F132','F1320','F1321','F1322','F13220','F13221','F13229','F1323','F13230','F13231','F13232','F13239','F1324',
		'F1325','F13250','F13251','F13259','F1326','F1327','F1328','F13280','F13281','F13282','F13288','F1329','F139','F1390','F1392','F13920','F13921','F13929','F1393','F13930','F13931','F13932',
		'F13939','F1394','F1395','F13950','F13951','F13959','F1396','F1397','F1398','F13980','F13981','F13982','F13988','F1399','F14','F141','F1410','F1411','F1412','F14120','F14121','F14122','F14129',
		'F1414','F1415','F14150','F14151','F14159','F1418','F14180','F14181','F14182','F14188','F1419','F142','F1420','F1421','F1422','F14220','F14221','F14222','F14229','F1423','F1424','F1425','F14250',
		'F14251','F14259','F1428','F14280','F14281','F14282','F14288','F1429','F149','F1490','F1492','F14920','F14921','F14922','F14929','F1494','F1495','F14950','F14951','F14959','F1498','F14980',
		'F14981','F14982','F14988','F1499','F15','F151','F1510','F1511','F1512','F15120','F15121','F15122','F15129','F1514','F1515','F15150','F15151','F15159','F1518','F15180','F15181','F15182',
		'F15188','F1519','F152','F1520','F1521','F1522','F15220','F15221','F15222','F15229','F1523','F1524','F1525','F15250','F15251','F15259','F1528','F15280','F15281','F15282','F15288','F1529','F159',
		'F1590','F1592','F15920','F15921','F15922','F15929','F1593','F1594','F1595','F15950','F15951','F15959','F1598','F15980','F15981','F15982','F15988','F1599','F16','F161','F1610','F1611','F1612',
		'F16120','F16121','F16122','F16129','F1614','F1615','F16150','F16151','F16159','F1618','F16180','F16183','F16188','F1619','F162','F1620','F1621','F1622','F16220','F16221','F16229','F1624','F1625',
		'F16250','F16251','F16259','F1628','F16280','F16283','F16288','F1629','F169','F1690','F1692','F16920','F16921','F16929','F1694','F1695','F16950','F16951','F16959','F1698','F16980','F16983',
		'F16988','F1699','F18','F181','F1810','F1811','F1812','F18120','F18121','F18129','F1814','F1815','F18150','F18151','F18159','F1817','F1818','F18180','F18188','F1819','F182','F1820','F1821',
		'F1822','F18220','F18221','F18229','F1824','F1825','F18250','F18251','F18259','F1827','F1828','F18280','F18288','F1829','F189','F1890','F1892','F18920','F18921','F18929','F1894','F1895','F18950',
		'F18951','F18959','F1897','F1898','F18980','F18988','F1899','F19','F191','F1910','F1911','F1912','F19120','F19121','F19122','F19129','F1914','F1915','F19150','F19151','F19159','F1916','F1917',
		'F1918','F19180','F19181','F19182','F19188','F1919','F192','F1920','F1921','F1922','F19220','F19221','F19222','F19229','F1923','F19230','F19231','F19232','F19239','F1924','F1925','F19250','F19251','F19259',
		'F1926','F1927','F1928','F19280','F19281','F19282','F19288','F1929','F199','F1990','F1992','F19920','F19921','F19922','F19929','F1993','F19930','F19931','F19932','F19939','F1994','F1995','F19950',
		'F19951','F19959','F1996','F1997','F1998','F19980','F19981','F19982','F19988','F1999'
		)

	--union

    	DROP TABLE IF EXISTS #PrimaryBHDx

	select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'ED visits with any primary BH dx' as Category
		into #PrimaryBHDx
		from FinalClaimsHeaderCode (readuncommitted) HC
		join FinalClaimsHeader (readuncommitted) H on H.ClaimNumber = HC.ClaimNumber and H.MVDID = HC.MVDID
		join FinalMember (readuncommitted) FM on FM.MVDID = HC.MVDID
		join #ERVisit ER on ER. MVDID = HC.MVDID
		where 
		DATEDIFF( DAY, H.StatementFromDate, GetUTCDate() ) <= 365  -- just claims in rolling 12 months
		and IsNull(HC.PrimaryIndicator,'N') = 'Y'
		and HC.CodeType = 'DIAG'				-- Look for Diagnosis codes
		and HC.CodeValue in
		(
		'F0781','F0789','F079','F09','F10','F1010','F1011','F1012','F10120','F10121','F10129','F1014','F1015','F10150','F10151','F10159','F1018','F10180','F10181','F10182','F10188','F1019',
		'F102','F1020','F1021','F1022','F10220','F10221','F10229','F1023','F10230','F10231','F10232','F10239','F1024','F1025','F10250','F10251','F10259','F1026','F1027','F1028','F10280','F10281',
		'F10282','F10288','F1029','F109','F1092','F10920','F10921','F10929','F1094','F1095','F10950','F10951','F10959','F1096','F1097','F1098','F10980','F10981','F10982','F10988','F1099','F11',
		'F111','F1110','F1111','F1112','F11120','F11121','F11122','F11129','F1114','F1115','F11150','F11151','F11159','F1118','F11181','F11182','F11188','F1119','F112','F1120','F1121','F1122',
		'F11220','F11221','F11222','F11229','F1123','F1124','F1125','F11250','F11251','F11259','F1128','F11281','F11282','F11288','F1129','F119','F1190','F1192','F11920','F11921','F11922','F11929','F1193','F1194','F1195',
		'F11950','F11951','F11959','F1198','F11981','F11982','F11988','F1199','F12','F121','F1210','F1211','F1212','F12120','F12121','F12122','F12129','F1215','F12150','F12151','F12159','F1218',
		'F12180','F12188','F1219','F122','F1220','F1221','F1222','F12220','F12221','F12222','F12229','F1225','F12250','F12251','F12259','F1228','F12280','F12288','F1229','F129','F1290','F1292',
		'F12920','F12921','F12922','F12929','F1295','F12950','F12951','F12959','F1298','F12980','F12988','F1299','F13','F131','F1310','F1311','F1312','F13120','F13121','F13129','F1314','F1315',
		'F13150','F13151','F13159','F1318','F13180','F13181','F13182','F13188','F1319','F132','F1320','F1321','F1322','F13220','F13221','F13229','F1323','F13230','F13231','F13232','F13239','F1324',
		'F1325','F13250','F13251','F13259','F1326','F1327','F1328','F13280','F13281','F13282','F13288','F1329','F139','F1390','F1392','F13920','F13921','F13929','F1393','F13930','F13931','F13932',
		'F13939','F1394','F1395','F13950','F13951','F13959','F1396','F1397','F1398','F13980','F13981','F13982','F13988','F1399','F14','F141','F1410','F1411','F1412','F14120','F14121','F14122','F14129',
		'F1414','F1415','F14150','F14151','F14159','F1418','F14180','F14181','F14182','F14188','F1419','F142','F1420','F1421','F1422','F14220','F14221','F14222','F14229','F1423','F1424','F1425','F14250',
		'F14251','F14259','F1428','F14280','F14281','F14282','F14288','F1429','F149','F1490','F1492','F14920','F14921','F14922','F14929','F1494','F1495','F14950','F14951','F14959','F1498','F14980','F14981',
		'F14982','F14988','F1499','F15','F151','F1510','F1511','F1512','F15120','F15121','F15122','F15129','F1514','F1515','F15150','F15151','F15159','F1518','F15180','F15181','F15182','F15188','F1519','F152',
		'F1520','F1521','F1522','F15220','F15221','F15222','F15229','F1523','F1524','F1525','F15250','F15251','F15259','F1528','F15280','F15281','F15282','F15288','F1529','F159','F1590','F1592','F15920',
		'F15921','F15922','F15929','F1593','F1594','F1595','F15950','F15951','F15959','F1598','F15980','F15981','F15982','F15988','F1599','F16','F161','F1610','F1611','F1612','F16120','F16121','F16122',
		'F16129','F1614','F1615','F16150','F16151','F16159','F1618','F16180','F16183','F16188','F1619','F162','F1620','F1621','F1622','F16220','F16221','F16229','F1624','F1625','F16250','F16251','F16259',
		'F1628','F16280','F16283','F16288','F1629','F169','F1690','F1692','F16920','F16921','F16929','F1694','F1695','F16950','F16951','F16959','F1698','F16980','F16983','F16988','F1699','F18','F181','F1810',
		'F1811','F1812','F18120','F18121','F18129','F1814','F1815','F18150','F18151','F18159','F1817','F1818','F18180','F18188','F1819','F182','F1820','F1821','F1822','F18220','F18221','F18229','F1824',
		'F1825','F18250','F18251','F18259','F1827','F1828','F18280','F18288','F1829','F189','F1890','F1892','F18920','F18921','F18929','F1894','F1895','F18950','F18951','F18959','F1897','F1898','F18980',
		'F18988','F1899','F19','F191','F1910','F1911','F1912','F19120','F19121','F19122','F19129','F1914','F1915','F19150','F19151','F19159','F1916','F1917','F1918','F19180','F19181','F19182','F19188','F1919','F192',
		'F1920','F1921','F1922','F19220','F19221','F19222','F19229','F1923','F19230','F19231','F19232','F19239','F1924','F1925','F19250','F19251','F19259','F1926','F1927','F1928','F19280','F19281','F19282',
		'F19288','F1929','F199','F1990','F1992','F19920','F19921','F19922','F19929','F1993','F19930','F19931','F19932','F19939','F1994','F1995','F19950','F19951','F19959','F1996','F1997','F1998','F19980',
		'F19981','F19982','F19988','F1999','F20','F200','F201','F202','F203','F205','F208','F2081','F2089','F209','F21','F22','F23','F24','F25','F250','F251','F258','F259','F28','F29','F30','F301','F3010',
		'F3011','F3012','F3013','F302','F303','F304','F308','F309','F31','F310','F311','F3110','F3111','F3112','F3113','F312','F313','F3130','F3131','F3132','F314','F315','F316','F3160','F3161','F3162','F3163',
		'F3164','F317','F3170','F3171','F3172','F3173','F3174','F3175','F3176','F3177','F3178','F318','F3181','F3189','F319','F32','F320','F321','F322','F323','F324','F325','F328','F3281','F3289','F329','F33',
		'F330','F331','F332','F333','F334','F3340','F3341','F3342','F338','F339','F34','F340','F341','F348','F3481','F3489','F349','F39','F40','F400','F4000','F4001','F4002','F401','F4010','F4011','F402','F4021',
		'F40210','F40218','F4022','F40220','F40228','F4023','F40230','F40231','F40232','F40233','F4024','F40240','F40241','F40242','F40243','F40248','F4029','F40290','F40291','F40298','F408','F409','F41','F410',
		'F411','F413','F418','F419','F42','F422','F423','F424','F428','F429','F43','F430','F431','F4310','F4311','F4312','F432','F4320','F4321','F4322','F4323','F4324','F4325','F4329','F438','F439','F44','F440',
		'F441','F442','F444','F445','F446','F447','F448','F4481','F4489','F449','F45','F450','F451','F452','F4520','F4521','F4522','F4529','F454','F4541','F4542','F458','F459','F48','F481','F482','F488','F489',
		'F50','F500','F5000','F5001','F5002','F502','F508','F5081','F5082','F5089','F509','F52','F520','F521','F522','F5221','F5222','F523','F5231','F5232','F524','F525','F526','F528','F529','F53','F54','F55','F550',
		'F551','F552','F553','F554','F558','F59','F60','F600','F601','F602','F603','F604','F605','F606','F607','F608','F6081','F6089','F609','F63','F630','F631','F632','F633','F638','F6381','F6389','F639','F64','F640',
		'F641','F642','F648','F649','F65','F650','F651','F652','F653','F654','F655','F6550','F6551','F6552','F658','F6581','F6589','F659','F66','F68','F681','F6810','F6811','F6812','F6813','F688','F69','F8082','F82','F840',
		'F843','F845','F848','F849','F88','F89','F90','F900','F901','F902','F908','F909','F91','F910','F911','F912','F913','F918','F919','F93','F930','F938','F939','F94','F940','F941','F942','F948','F949','F98','F980',
		'F981','F9821','F9829','F983','F988','F989','F99','R45851','T1491','T1491XA','T1491XD','T1491XS','T360X2A','T360X2D','T360X2S','T361X2A','T361X2D','T361X2S','T362X2A','T362X2D','T362X2S','T363X2A','T363X2D',
		'T363X2S','T364X2A','T364X2D','T364X2S','T365X2A','T365X2D','T365X2S','T366X2A','T366X2D','T366X2S','T367X2A','T367X2D','T367X2S','T368X2A','T368X2D','T368X2S','T3692XA','T3692XD','T3692XS','T370X2A',
		'T370X2D','T370X2S','T371X2A','T371X2D','T371X2S','T372X2A','T372X2D','T372X2S','T373X2A','T373X2D','T373X2S','T374X2A','T374X2D','T374X2S','T375X2A','T375X2D','T375X2S','T378X2A','T378X2D','T378X2S',
		'T3792XA','T3792XD','T3792XS','T380X2A','T380X2D','T380X2S','T381X2A','T381X2D','T381X2S','T382X2A','T382X2D','T382X2S','T383X2A','T383X2D','T383X2S','T384X2A','T384X2D','T384X2S','T385X2A','T385X2D',
		'T385X2S','T386X2A','T386X2D','T386X2S','T387X2A','T387X2D','T387X2S','T38802A','T38802D','T38802S','T38812A','T38812D','T38812S','T38892A','T38892D','T38892S','T38902A','T38902D','T38902S','T38992A','T38992D',
		'T38992S','T39012A','T39012D','T39012S','T39092A','T39092D','T39092S','T391X2A','T391X2D','T391X2S','T392X2A','T392X2D','T392X2S','T39312A','T39312D','T39312S','T39392A','T39392D','T39392S','T394X2A',
		'T394X2D','T394X2S','T398X2A','T398X2D','T398X2S','T3992XA','T3992XD','T3992XS','T400X2A','T400X2D','T400X2S','T401X2A','T401X2D','T401X2S','T402X1A','T402X1D','T402X1S','T402X2A','T402X2D','T402X2S',
		'T402X4A','T402X4D','T402X4S','T403X1A','T403X1D','T403X1S','T403X2A','T403X2D','T403X2S','T403X4A','T403X4D','T403X4S','T404X1A','T404X1D','T404X1S','T404X2A','T404X2D','T404X2S','T404X4A','T404X4D',
		'T404X4S','T405X2A','T405X2D','T405X2S','T40601A','T40601D','T40601S','T40602A','T40602D','T40602S','T40604A','T40604D','T40604S','T40691A','T40691D','T40691S','T40692A','T40692D','T40692S','T40694A',
		'T40694D','T40694S','T407X2A','T407X2D','T407X2S','T408X2A','T408X2D','T408X2S','T40902A','T40902D','T40902S','T40992A','T40992D','T40992S','T410X2A','T410X2D','T410X2S','T411X2A','T411X2D','T411X2S',
		'T41202A','T41202D','T41202S','T41292A','T41292D','T41292S','T413X2A','T413X2D','T413X2S','T4142XA','T4142XD','T4142XS','T415X2A','T415X2D','T415X2S','T420X2A','T420X2D','T420X2S','T421X2A','T421X2D',
		'T421X2S','T422X2A','T422X2D','T422X2S','T423X1A','T423X1D','T423X1S','T423X2A','T423X2D','T423X2S','T423X4A','T423X4D','T423X4S','T424X1A','T424X1D','T424X1S','T424X2A','T424X2D','T424X2S','T424X4A',
		'T424X4D','T424X4S','T425X2A','T425X2D','T425X2S','T426X2A','T426X2D','T426X2S','T4272XA','T4272XD','T4272XS','T428X1A','T428X1D','T428X1S','T428X2A','T428X2D','T428X2S','T428X4A','T428X4D','T428X4S',
		'T43011A','T43011D','T43011S','T43012A','T43012D','T43012S','T43014A','T43014D','T43014S','T43021A','T43021D','T43021S','T43022A','T43022D','T43022S','T43024A','T43024D','T43024S','T431X1A','T431X1D',
		'T431X1S','T431X2A','T431X2D','T431X2S','T431X4A','T431X4D','T431X4S','T43201A','T43201D','T43201S','T43202A','T43202D','T43202S','T43204A','T43204D','T43204S','T43211A','T43211D','T43211S','T43212A',
		'T43212D','T43212S','T43214A','T43214D','T43214S','T43221A','T43221D','T43221S','T43222A','T43222D','T43222S','T43224A','T43224D','T43224S','T43291A','T43291D','T43291S','T43292A','T43292D','T43292S',
		'T43294A','T43294D','T43294S','T433X1A','T433X1D','T433X1S','T433X2A','T433X2D','T433X2S','T434X2A','T434X2D','T434X2S','T43501A','T43501D','T43501S','T43502A','T43502D','T43502S','T43504A','T43504D',
		'T43504S','T43591A','T43591D','T43591S','T43592A','T43592D','T43592S','T43594A','T43594D','T43594S','T43601A','T43601D','T43601S','T43602A','T43602D','T43602S','T43604A','T43604D','T43604S','T43612A',
		'T43612D','T43612S','T43621A','T43621D','T43621S','T43622A','T43622D','T43622S','T43624A','T43624D','T43624S','T43631A','T43631D','T43631S','T43632A','T43632D','T43632S','T43634A','T43634D','T43634S','T43641A',
		'T43641D','T43641S','T43642A','T43642D','T43642S','T43644A','T43644D','T43644S','T43691A','T43691D','T43691S','T43692A','T43692D','T43692S','T43694A','T43694D','T43694S','T438X2A','T438X2D','T438X2S',
		'T4392XA','T4392XD','T4392XS','T4394XA','T4394XD','T4394XS','T440X2A','T440X2D','T440X2S','T441X2A','T441X2D','T441X2S','T442X2A','T442X2D','T442X2S','T443X2A','T443X2D','T443X2S','T444X2A','T444X2D',
		'T444X2S','T445X2A','T445X2D','T445X2S','T446X2A','T446X2D','T446X2S','T447X2A','T447X2D','T447X2S','T448X2A','T448X2D','T448X2S','T44902A','T44902D','T44902S','T44992A','T44992D','T44992S','T450X2A',
		'T450X2D','T450X2S','T451X2A','T451X2D','T451X2S','T452X2A','T452X2D','T452X2S','T453X2A','T453X2D','T453X2S','T454X2A','T454X2D','T454X2S','T45512A','T45512D','T45512S','T45522A','T45522D','T45522S',
		'T45602A','T45602D','T45602S','T45612A','T45612D','T45612S','T45622A','T45622D','T45622S','T45692A','T45692D','T45692S','T457X2A','T457X2D','T457X2S','T458X2A','T458X2D','T458X2S','T4592XA','T4592XD','T4592XS',
		'T460X2A','T460X2D','T460X2S','T461X2A','T461X2D','T461X2S','T462X2A','T462X2D','T462X2S','T463X2A','T463X2D','T463X2S','T464X2A','T464X2D','T464X2S','T465X2A','T465X2D','T465X2S','T466X2A','T466X2D','T466X2S',
		'T467X2A','T467X2D','T467X2S','T468X2A','T468X2D','T468X2S','T46902A','T46902D','T46902S','T46992A','T46992D','T46992S','T470X2A','T470X2D','T470X2S','T471X2A','T471X2D','T471X2S','T472X2A','T472X2D',
		'T472X2S','T473X2A','T473X2D','T473X2S','T474X2A','T474X2D','T474X2S','T475X2A','T475X2D','T475X2S','T476X2A','T476X2D','T476X2S','T477X2A','T477X2D','T477X2S','T478X2A','T478X2D','T478X2S','T4792XA',
		'T4792XD','T4792XS','T480X2A','T480X2D','T480X2S','T481X2A','T481X2D','T481X2S','T48202A','T48202D','T48202S','T48292A','T48292D','T48292S','T483X2A','T483X2D','T483X2S','T484X2A','T484X2D','T484X2S',
		'T485X2A','T485X2D','T485X2S','T486X2A','T486X2D','T486X2S','T48902A','T48902D','T48902S','T48992A','T48992D','T48992S','T490X2A','T490X2D','T490X2S','T491X2A','T491X2D','T491X2S','T492X2A','T492X2D',
		'T492X2S','T493X2A','T493X2D','T493X2S','T494X2A','T494X2D','T494X2S','T495X2A','T495X2D','T495X2S','T496X2A','T496X2D','T496X2S','T497X2A','T497X2D','T497X2S','T498X2A','T498X2D','T498X2S','T4992XA',
		'T4992XD','T4992XS','T500X2A','T500X2D','T500X2S','T501X2A','T501X2D','T501X2S','T502X2A','T502X2D','T502X2S','T503X2A','T503X2D','T503X2S','T504X2A','T504X2D','T504X2S','T505X2A','T505X2D','T505X2S',
		'T506X2A','T506X2D','T506X2S','T507X2A','T507X2D','T507X2S','T508X2A','T508X2D','T508X2S','T50902A','T50902D','T50902S','T50992A','T50992D','T50992S','T50A12A','T50A12D','T50A12S','T50A22A','T50A22D',
		'T50A22S','T50A92A','T50A92D','T50A92S','T50B12A','T50B12D','T50B12S','T50B92A','T50B92D','T50B92S','T50Z12A','T50Z12D','T50Z12S','T50Z92A','T50Z92D','T50Z92S','T510X2A','T510X2D','T510X2S','T511X2A',
		'T511X2D','T511X2S','T512X2A','T512X2D','T512X2S','T513X2A','T513X2D','T513X2S','T518X2A','T518X2D','T518X2S','T5192XA','T5192XD','T5192XS','T520X2A','T520X2D','T520X2S','T521X2A','T521X2D','T521X2S',
		'T522X2A','T522X2D','T522X2S','T523X2A','T523X2D','T523X2S','T524X2A','T524X2D','T524X2S','T528X2A','T528X2D','T528X2S','T5292XA','T5292XD','T5292XS','T530X2A','T530X2D','T530X2S','T531X2A','T531X2D',
		'T531X2S','T532X2A','T532X2D','T532X2S','T533X2A','T533X2D','T533X2S','T534X2A','T534X2D','T534X2S','T535X2A','T535X2D','T535X2S','T536X2A','T536X2D','T536X2S','T537X2A','T537X2D','T537X2S','T5392XA',
		'T5392XD','T5392XS','T540X2A','T540X2D','T540X2S','T541X2A','T541X2D','T541X2S','T542X2A','T542X2D','T542X2S','T543X2A','T543X2D','T543X2S','T5492XA','T5492XD','T5492XS','T550X2A','T550X2D','T550X2S','T551X2A',
		'T551X2D','T551X2S','T560X2A','T560X2D','T560X2S','T561X2A','T561X2D','T561X2S','T562X2A','T562X2D','T562X2S','T563X2A','T563X2D','T563X2S','T564X2A','T564X2D','T564X2S','T565X2A','T565X2D','T565X2S',
		'T566X2A','T566X2D','T566X2S','T567X2A','T567X2D','T567X2S','T56812A','T56812D','T56812S','T56892A','T56892D','T56892S','T5692XA','T5692XD','T5692XS','T570X2A','T570X2D','T570X2S','T571X2A','T571X2D',
		'T571X2S','T572X2A','T572X2D','T572X2S','T573X2A','T573X2D','T573X2S','T578X2A','T578X2D','T578X2S','T5792XA','T5792XD','T5792XS','T5802XA','T5802XD','T5802XS','T5812XA','T5812XD','T5812XS','T582X2A',
		'T582X2D','T582X2S','T588X2A','T588X2D','T588X2S','T5892XA','T5892XD','T5892XS','T590X2A','T590X2D','T590X2S','T591X2A','T591X2D','T591X2S','T592X2A','T592X2D','T592X2S','T593X2A','T593X2D','T593X2S',
		'T594X2A','T594X2D','T594X2S','T595X2A','T595X2D','T595X2S','T596X2A','T596X2D','T596X2S','T597X2A','T597X2D','T597X2S','T59812A','T59812D','T59812S','T59892A','T59892D','T59892S','T5992XA','T5992XD','T5992XS',
		'T600X2A','T600X2D','T600X2S','T601X2A','T601X2D','T601X2S','T602X2A','T602X2D','T602X2S','T603X2A','T603X2D','T603X2S','T604X2A','T604X2D','T604X2S','T608X2A','T608X2D','T608X2S','T6092XA','T6092XD','T6092XS',
		'T6102XA','T6102XD','T6102XS','T6112XA','T6112XD','T6112XS','T61772A','T61772D','T61772S','T61782A','T61782D','T61782S','T618X2A','T618X2D','T618X2S','T6192XA','T6192XD','T6192XS','T620X2A','T620X2D',
		'T620X2S','T621X2A','T621X2D','T621X2S','T622X2A','T622X2D','T622X2S','T628X2A','T628X2D','T628X2S','T6292XA','T6292XD','T6292XS','T63002A','T63002D','T63002S','T63012A','T63012D','T63012S','T63022A',
		'T63022D','T63022S','T63032A','T63032D','T63032S','T63042A','T63042D','T63042S','T63062A','T63062D','T63062S','T63072A','T63072D','T63072S','T63082A','T63082D','T63082S','T63092A','T63092D','T63092S',
		'T63112A','T63112D','T63112S','T63122A','T63122D','T63122S','T63192A','T63192D','T63192S','T632X2A','T632X2D','T632X2S','T63302A','T63302D','T63302S','T63312A','T63312D','T63312S','T63322A','T63322D',
		'T63322S','T63332A','T63332D','T63332S','T63392A','T63392D','T63392S','T63412A','T63412D','T63412S','T63422A','T63422D','T63422S','T63432A','T63432D','T63432S','T63442A','T63442D','T63442S','T63452A','T63452D',
		'T63452S','T63462A','T63462D','T63462S','T63482A','T63482D','T63482S','T63512A','T63512D','T63512S','T63592A','T63592D','T63592S','T63612A','T63612D','T63612S','T63622A','T63622D','T63622S','T63632A',
		'T63632D','T63632S','T63692A','T63692D','T63692S','T63712A','T63712D','T63712S','T63792A','T63792D','T63792S','T63812A','T63812D','T63812S','T63822A','T63822D','T63822S','T63832A','T63832D','T63832S',
		'T63892A','T63892D','T63892S','T6392XA','T6392XD','T6392XS','T6402XA','T6402XD','T6402XS','T6482XA','T6482XD','T6482XS','T650X2A','T650X2D','T650X2S','T651X2A','T651X2D','T651X2S','T65212A','T65212D',
		'T65212S','T65222A','T65222D','T65222S','T65292A','T65292D','T65292S','T653X2A','T653X2D','T653X2S','T654X2A','T654X2D','T654X2S','T655X2A','T655X2D','T655X2S','T656X2A','T656X2D','T656X2S','T65812A',
		'T65812D','T65812S','T65822A','T65822D','T65822S','T65832A','T65832D','T65832S','T65892A','T65892D','T65892S','T6592XA','T6592XD','T6592XS','T71112A','T71112D','T71112S','T71122A','T71122D','T71122S',
		'T71132A','T71132D','T71132S','T71152A','T71152D','T71152S','T71162A','T71162D','T71162S','T71192A','T71192D','T71192S','T71222A','T71222D','T71222S','T71232A','T71232D','T71232S','X710XXA','X710XXD',
		'X710XXS','X711XXA','X711XXD','X711XXS','X712XXA','X712XXD','X712XXS','X713XXA','X713XXD','X713XXS','X718XXA','X718XXD','X718XXS','X719XXA','X719XXD','X719XXS','X72XXXA','X72XXXD','X72XXXS','X730XXA',
		'X730XXD','X730XXS','X731XXA','X731XXD','X731XXS','X732XXA','X732XXD','X732XXS','X738XXA','X738XXD','X738XXS','X739XXA','X739XXD','X739XXS','X7401XA','X7401XD','X7401XS','X7402XA','X7402XD','X7402XS',
		'X7409XA','X7409XD','X7409XS','X748XXA','X748XXD','X748XXS','X749XXA','X749XXD','X749XXS','X75XXXA','X75XXXD','X75XXXS','X76XXXA','X76XXXD','X76XXXS','X770XXA','X770XXD','X770XXS','X771XXA','X771XXD',
		'X771XXS','X772XXA','X772XXD','X772XXS','X773XXA','X773XXD','X773XXS','X778XXA','X778XXD','X778XXS','X779XXA','X779XXD','X779XXS','X780XXA','X780XXD','X780XXS','X781XXA','X781XXD','X781XXS','X782XXA',
		'X782XXD','X782XXS','X788XXA','X788XXD','X788XXS','X789XXA','X789XXD','X789XXS','X79XXXA','X79XXXD','X79XXXS','X80XXXA','X80XXXD','X80XXXS','X810XXA','X810XXD','X810XXS','X811XXA','X811XXD','X811XXS',
		'X818XXA','X818XXD','X818XXS','X820XXA','X820XXD','X820XXS','X821XXA','X821XXD','X821XXS','X822XXA','X822XXD','X822XXS','X828XXA','X828XXD','X828XXS','X830XXA','X830XXD','X830XXS','X831XXA','X831XXD',
		'X831XXS','X832XXA','X832XXD','X832XXS','X838XXA','X838XXD','X838XXS','Z915'
		)


    TRUNCATE TABLE [dbo].[RecordsforNDBHInsert]

--select distinct HC.MVDID, FM.MemberID, FM.MemberLastName,FM.MemberFirstName, FM.DateOfBirth,FM.Gender, FM.CmOrgRegion,ER.ErCount,'Axis 2 personality disorders (Borderline PD or Dependent PD)' as Category

	INSERT INTO dbo.RecordsforNDBHInsert
	(MVDID,MemberID,MemberLastName,MemberFirstName,DOB)
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #PanicAnxietydisorders
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #personalitydisorders
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #bipolardisorders
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #Schizophrenia
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #Suicidology
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #Eatingdisorder
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #SUDDx
	union
	select MVDID,MemberID,MemberLastName,MemberFirstName,DateOfBirth from #PrimaryBHDx
	OPTION (MERGE UNION);  

	END

	
--select * from [dbo].[RecordsforNDBHInsert]